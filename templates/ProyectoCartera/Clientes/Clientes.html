{% extends "ProyectoCartera/base.html" %}



{% block title %}Clientes{% endblock %}

{% block body %}

    <div class="table-responsive m-5">
         <table id="example" class="display nowrap" width="100%"></table>
    </div>
    <div class="row m-5">
        <a href="{% url 'agregar_cliente' %}" class="btn btn-primary"> Agregar Cliente </a>
    </div>
    <script>
        $('#example').DataTable({
            fixedHeader: true,
            responsive: true,
            language: {
                "url": "//cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json"
            },
            columns: [
                { title: 'Contrato' },
                { title: 'Asesor' },
                { title: 'Cliente' },
                { title: 'Valor.' },
                { title: 'Descripcion' },
                {
                    title: 'Acciones',
                    render: function (data, type, row, meta) {
                        return '<button class="btn btn-info" onclick="editarcliente(' + row[0] +')">Editar</button> ' +
                            ' <button class="btn btn-danger" onclick="eliminarCliente(' + row[0] +')">Eliminar</button>';
                    }
                }
            ],
            data: {{ Clientes|safe }}
        });

        function editarcliente(contratoId) {
            window.location.href = "/editarClienteVista/" + contratoId.toString()
        }
    </script>


    {% if messages %}
            {% for mensaje in messages %}
                {% if mensaje.tags == 'success' %}
                    <script>
                        Swal.fire({
                            title: "{{ mensaje }}",
                            icon: "success"
                        });
                    </script>

                {% elif mensaje.tags == 'danger' %}
                    <script>
                        Swal.fire({
                            title: "ERROR!",
                            text: "{{ mensaje }}",
                            icon: "error"
                        });
                    </script>
                {% endif %}
            {% endfor %}
        {% endif %}

    {% block js %}
        <script>
            function eliminarCliente(id){
                Swal.fire({
                      title: "Â¿Esta seguro que quiere eliminar el cliente?",
                      text: "Esta accion no es reversible!",
                      icon: "warning",
                      showCancelButton: true,
                      confirmButtonColor: "#3085d6",
                      cancelButtonColor: "#d33",
                      confirmButtonText: "Eliminar"
                }).then((result) => {
                      if (result.isConfirmed) {
                          window.location.href = "/EliminacionCliente/" + id
                      }
                });
            }
        </script>
    {% endblock %}
{% endblock %}



